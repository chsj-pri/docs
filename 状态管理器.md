# 状态管理器

### react 状态管理工具的流派？
没有状态管理工具：直接用 props 或者 context
单项数据流：redux、zustand
双向绑定：mobx、valtio
状态原子化：jotai、recoil
有限状态机：xstate

### 什么是状态管理?
“状态”是描述应用程序当前行为的任何数据。这可能包括诸如“从服务器获取的对象列表”、“当前选择的项目”、“当前登录用户的名称”和“此模式是否打开？”等值。
在研发一个复杂应用的过程中，一套好的状态管理方案是必不可少的，既能提升研发效率，又能降低研发维护成本

### react已经有状态管理的功能了，为什么还要专门的状态管理的库？
*原因：*
**全局状态管理：** React内置的状态管理是局部的，只适用于单个组件。在大型应用程序中，可能需要将某些状态共享给多个组件，而专门的状态管理库能更容易实现全局状态管理。

**组件解耦：** 使用专门的状态管理库可以帮助解耦组件，使其更容易维护和测试。它可以让你更容易地管理数据的流向，而不会导致组件之间的深度嵌套或复杂的props传递。

**可预测性：** 状态管理库通常提供一种可预测的状态变化方式，例如Redux的纯函数reducers。这有助于更容易理解应用程序的状态变化，减少了副作用和难以调试的情况。

**性能优化：** 专门的状态管理库通常具有性能优化功能，例如对状态变化的订阅和选择性重新渲染，以确保应用程序保持高性能。

**开发者社区和工具支持：** 一些状态管理库（例如Redux和MobX）具有广泛的开发者社区支持和丰富的生态系统，包括调试工具、中间件和插件，这些工具可以加速开发和调试过程。

**多框架支持：** 专门的状态管理库通常不限于React，可以在不同的框架中使用，例如Vue.js或Angular。

> 总之，专门的状态管理库为开发大型、复杂或需要高级状态管理的应用程序提供了更强大和灵活的工具。然而，对于小型或简单的应用，React的内置状态管理通常足够满足需求，避免了引入额外的复杂性。选择使用哪种状态管理方法取决于你的应用程序需求和团队的经验。

### 将数据放入状态管理器中通常取决于以下因素：
**共享性：** 数据需要在多个组件之间共享或传递时，将其放入状态管理器中非常有用。状态管理器允许不同组件访问相同的数据，以保持数据的一致性。

**全局性：** 如果数据需要在整个应用程序中保持一致，例如用户身份验证状态、应用程序配置、主题设置等，这些数据通常适合放入全局状态管理器中。

**复杂性：** 当数据变得复杂且需要更多的状态控制时，状态管理器可以提供更强大的工具来处理数据的操作和变化。例如，如果数据有多个属性、嵌套结构、或需要复杂的逻辑来更新，状态管理器通常更合适。

**可变性：** 对于需要频繁更新的数据，状态管理器通常更适合。状态管理库可以帮助你管理数据的变化，确保组件在数据变化时重新渲染。

**持久性：** 如果数据需要在组件卸载后仍然存在，例如缓存的数据，将其存储在状态管理器中可能更合适。

**数据来源：** 当数据来自异步请求、外部API、WebSocket或其他外部数据源时，状态管理器通常用于管理这些异步数据的状态。

**性能优化：** 状态管理器通常提供了性能优化的机制，例如选择性重新渲染，以确保只有真正需要的组件重新渲染。这对于大型数据集或需要高性能的应用程序非常有用。

**跨组件传递：** 如果你需要在组件之间传递数据，但不希望使用props一层层传递，状态管理器提供了更简便的方法。

> 需要注意的是，不是所有的数据都需要放入状态管理器中。某些数据可能适合作为组件级的局部状态，而不需要共享给其他组件。在决定将数据放入状态管理器中之前，要仔细考虑数据的范围、可见性和复杂性，以确保选择适当的管理方式。使用状态管理器来管理全局、共享、复杂或需要特殊状态控制的数据，而将局部性和组件内部的数据保留为组件级状态通常是一个好的实践。

### 从http请求返回的数据适合放到专门的状态管理器管理吗？
> 将从 HTTP 请求返回的数据放入专门的状态管理器通常是一种很好的实践，尤其是当这些数据需要在多个组件之间共享、操作、或需要保持一致性时。以下是一些理由为什么将 HTTP 请求返回的数据放入状态管理器中是有意义的：

**数据共享和一致性：** 当多个组件需要访问相同的数据时，将数据放入状态管理器中可确保这些组件共享相同的数据，从而保持数据的一致性。

**可预测的状态管理：** 状态管理器提供了一种可预测的方式来管理数据的状态。你可以定义数据的初始状态、如何更新数据以及如何处理错误情况。

**数据操作和变化：** 状态管理器通常提供了方法和操作来修改和更新数据。这对于数据的增删改查以及与数据相关的业务逻辑非常有用。

**性能优化：** 状态管理器通常提供了选择性重新渲染的机制，以确保只有订阅了数据的组件会在数据变化时重新渲染。这有助于提高应用程序的性能。

**持久性：** 数据可以在状态管理器中保持持久性，即使组件卸载或导航到其他页面，数据仍然可以保持不变。

**全局访问：** 状态管理器可以在整个应用程序中访问，而不需要将数据传递给每个需要它的组件。这减少了冗余的数据传递和维护。

**错误处理：** 状态管理器可以处理请求错误，提供一种一致的方式来处理和显示错误信息。

> 然而，不是所有 HTTP 请求返回的数据都需要放入状态管理器中。对于临时性的或仅在特定组件内使用的数据，将其保存为组件级的局部状态通常更合适。状态管理器主要适用于全局>性、共享性或需要在整个应用程序中共享和操作的数据。

> 总结来说，将 HTTP 请求返回的数据放入专门的状态管理器通常是一个明智的选择，特别是对于大型应用程序，这有助于更好地管理数据、提高性能和确保数据的一致性。

### 对于前端开发，页面的UI逻辑和业务逻辑，如何做能更好的解耦？
*为了更好地解耦前端开发中的页面的UI逻辑和业务逻辑，你可以采用以下策略和模式：*

**组件化开发：** 将页面拆分为可复用的组件，每个组件负责特定的UI和业务逻辑。这样可以使每个组件都相对独立，容易维护和测试。

**容器组件和展示组件分离：** 使用容器组件和展示组件的模式，容器组件负责业务逻辑和数据管理，而展示组件负责呈现UI。这样可以确保UI组件不关心业务逻辑，使它们更容易复用。

**单一职责原则：** 确保每个组件或模块只负责一个特定的职责。这有助于确保每个组件的责任清晰，并降低了组件之间的耦合度。

**状态管理：** 使用专门的状态管理库（如Redux、MobX、Zustand）来管理应用程序的状态。这可以帮助隔离UI组件和业务逻辑，以确保UI组件不直接访问或修改状态，而通过状态管理器进行交互。

**事件驱动架构：** 使用事件驱动的架构，使UI组件和业务逻辑组件通过事件或消息进行通信。这可以降低组件之间的直接依赖，并促进松耦合。

**依赖注入：** 将依赖项注入到组件中，而不是在组件内部直接实例化它们。这使得依赖关系更明确，便于测试和替换依赖项。

**使用中间件和服务：** 将通用的业务逻辑封装为中间件或服务，以便在多个组件之间共享。这有助于消除代码重复和确保一致性。

**数据接口抽象：** 将数据获取和处理的接口从UI组件中抽象出来，以便在后端API或数据存储发生变化时更容易进行切换和升级。

**模块化开发：** 使用模块化的方式组织代码，将UI组件、业务逻辑和数据逻辑放在不同的模块中。这有助于明确划分各个部分的职责。

**文档和注释：** 为代码和组件提供清晰的文档和注释，以便其他开发人员能够理解组件的用途和工作方式。这可以降低协作和维护的难度。

> 通过采用这些策略，你可以更好地解耦前端应用的UI逻辑和业务逻辑，使代码更容易维护、测试和扩展。这有助于提高代码质量、可维护性和可扩展性。

### 对于一个前端项目，注重UI逻辑和业务逻辑的解耦，以及追求代码的简洁，请问选择哪个状态管理器更加的适用？
*如果你注重前端项目中的UI逻辑和业务逻辑的解耦，以及追求代码的简洁，那么可以考虑选择 Zustand 状态管理库。Zustand 具有以下特点，使其适合这种情况：*

**简洁性：** Zustand 是一个非常轻量级的状态管理库，API 简单明了，学习曲线较低。它鼓励使用函数式编程风格来管理状态，这有助于编写干净、简洁的代码。

**React 集成：** Zustand 是与 React 紧密集成的，因此它自然地与 React 组件协同工作，无需引入复杂的概念或模式。

**组件级状态：** Zustand鼓励将状态存储在组件级，这有助于减小状态的作用范围，降低了组件之间的耦合度，提高了代码的可维护性。

**性能优化：** Zustand 提供了性能优化机制，只有订阅了状态的组件会在状态更改时重新渲染，这有助于提高应用程序的性能。

**可预测性：** 使用 Zustand，你可以清晰地追踪状态的变化以及如何影响你的组件，这有助于提高代码的可预测性。

**非常灵活：** Zustand 是非常灵活的，你可以根据项目需求设计自己的状态管理结构，而不受限于特定的模式或规范。

**单一数据源：** 与一些状态管理库不同，Zustand鼓励使用多个状态存储，每个存储处理特定的数据集。这有助于代码的简洁性和可维护性。

> 需要注意的是，虽然 Zustand 是一个很好的选择，但它适用于小到中型的项目和应用。对于复杂的大型项目，你可能需要更强大的状态管理库，如 Redux 或 MobX，来处理更复杂的状态管理需求。

> 总结来说，如果你的项目注重UI逻辑和业务逻辑的解耦，并且你希望代码简洁且易于维护，Zustand 是一个优秀的选择。根据项目的规模和需求，你可以选择最适合的状态管理库。

### 参考
zustand
react-query

[***\*react-awesome-query-builder\****](https://github.com/ukrbublik/react-awesome-query-builder)

Immer

https://juejin.cn/post/7105426666020667405

https://juejin.cn/post/6911327118483947528?from=search-suggest
normalize.css

